package de.tschuehly.htmx.spring.supabase.auth.types

import com.auth0.jwt.JWT
import com.auth0.jwt.algorithms.Algorithm
import com.auth0.jwt.interfaces.Claim
import com.auth0.jwt.interfaces.DecodedJWT
import org.junit.jupiter.api.Assertions.*
import org.junit.jupiter.api.Test

class SupabaseUserTest{
    val jwtVerifier = JWT.require(Algorithm.HMAC256("test")).build()
    @Test
    fun createSupabaseUser(){
        val jwt = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNzIwNzg5NDA2LCJpYXQiOjE3MjA0Mjk0MDksImlzcyI6Imh0dHBzOi8vbGxoZ3l0em9sdWNhc3B4Y2FrZ24uc3VwYWJhc2UuY28vYXV0aC92MSIsInN1YiI6IjRlNzQ1ODllLWQ1NTMtNDYxMC05OTBhLTBjZjFhYTU4YTNjMSIsImVtYWlsIjoidGhvbWFzLnNjaHVlaGx5Lm1pYmlAZ21haWwuY29tIiwicGhvbmUiOiIiLCJhcHBfbWV0YWRhdGEiOnsicHJvdmlkZXIiOiJnb29nbGUiLCJwcm92aWRlcnMiOlsiZ29vZ2xlIl19LCJ1c2VyX21ldGFkYXRhIjp7ImN1c3RvbV9jbGFpbXMiOnsiaGQiOiJzdHVkaW9zYWx0LmNvIn0sImF2YXRhcl91cmwiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NJMUkwaFFuc3NXMHNQUGwwRVRXRS1KNkNiVkFFSVpwV2tqZHBKWlZRajlfQUV0N0otWWRBPXM5Ni1jIiwiZW1haWwiOiJ0aG9tYXMuc2NodWVobHkubWliaUBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiZnVsbF9uYW1lIjoiVGhvbWFzIiwiaXNzIjoiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tIiwibmFtZSI6IlRob21hcyIsInBob25lX3ZlcmlmaWVkIjpmYWxzZSwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0kxSTBoUW5zc1cwc1BQbDBFVFdFLUo2Q2JWQUVJWnBXa2pkcEpaVlFqOV9BRXQ3Si1ZZEE9czk2LWMiLCJwcm92aWRlcl9pZCI6IjEwNzIwNzQ3NTExODc2NzE0NjMyNyIsInN1YiI6IjEwNzIwNzQ3NTExODc2NzE0NjMyNyJ9LCJyb2xlIjoiYXV0aGVudGljYXRlZCIsImFhbCI6ImFhbDEiLCJhbXIiOlt7Im1ldGhvZCI6Im9hdXRoIiwidGltZXN0YW1wIjoxNzIwNDI5NDA5fV0sInNlc3Npb25faWQiOiJhZDFiMDZiYy1lZTYzLTQ2MmYtODBjNi1lODk2NjJmOTEwMDgiLCJpc19hbm9ueW1vdXMiOmZhbHNlfQ.O36desqPaAUcXaqqJsth9G507fm2GYi33W5HsRrHCJE"
        val verifiedJwt: DecodedJWT = jwtVerifier.verify(jwt)
        SupabaseUser.createFromJWT(verifiedJwt)
    }
}